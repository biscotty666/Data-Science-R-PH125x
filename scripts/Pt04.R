## ---------------------------------------------------------------------------------------------
library(tidyverse)


## ---------------------------------------------------------------------------------------------
library(dslabs)
data(murders)
head(murders)


## ---------------------------------------------------------------------------------------------
# co2


## ---------------------------------------------------------------------------------------------
class(ChickWeight)


## ---------------------------------------------------------------------------------------------
BOD


## ---------------------------------------------------------------------------------------------
library(dslabs)
data("murders")
murders <- mutate(murders, 
                  rate = total / population * 10^5)
head(murders)


## ---------------------------------------------------------------------------------------------
filter(murders, rate <= 0.71)


## ---------------------------------------------------------------------------------------------
new_table <- select(murders, state, region, rate)
filter(new_table, rate <= 0.71)


## ---------------------------------------------------------------------------------------------
library(dplyr)
library(dslabs)
data(murders)


## ---------------------------------------------------------------------------------------------
murders <- mutate(murders,
                  rate = total / population * 10^5)
head(murders)


## ---------------------------------------------------------------------------------------------
murders <- mutate(murders,
       rank = rank(-murders$total))
head(murders)


## ---------------------------------------------------------------------------------------------
select(murders, state, abb) |> head()


## ---------------------------------------------------------------------------------------------
filter(murders, rank <= 5.0)


## ---------------------------------------------------------------------------------------------
no_south <- filter(murders, region != "South")
nrow(no_south)


## ---------------------------------------------------------------------------------------------
murders_nw <- filter(murders, region %in% c("Northeast", "South"))
nrow(murders_nw)


## ---------------------------------------------------------------------------------------------
murders |> 
  filter(rate < 1 & region %in% c("Northeast", "West")) |>
  select(state, rate, rank)


## ---------------------------------------------------------------------------------------------
murders |> 
  select(state, region, rate) |>
  filter(rate <= 0.71)


## ---------------------------------------------------------------------------------------------
16 |> sqrt() |> log2()


## ---------------------------------------------------------------------------------------------
murders <- mutate(murders, rate =  total / population * 100000, 
                  rank = rank(-rate))


## ---------------------------------------------------------------------------------------------
murders |>
  mutate(rate = total / population * 10^5,
         rank = rank(-rate)) |>
  filter(region %in% c("Northeast", "West") &
           rate < 1) |>
  select(state, rate, rank) -> my_states
my_states


## ---------------------------------------------------------------------------------------------
library(dplyr)
library(dslabs)
data(heights)
head(heights)


## ---------------------------------------------------------------------------------------------
s <- heights |>
  filter(sex == "Female") |>
  summarise(average = mean(height), standard_deviation = sd(height))
s


## ---------------------------------------------------------------------------------------------
s$average
s$standard_deviation


## ---------------------------------------------------------------------------------------------
summarise(murders, mean(rate))


## ---------------------------------------------------------------------------------------------
us_murder_rate <- murders |>
  summarise(rate = sum(total) / sum(population) * 100000)
us_murder_rate


## ---------------------------------------------------------------------------------------------
heights |>
  filter(sex == "Female") |>
  summarise(median_min_max = quantile(height, c(0.5, 0, 1)))


## ---------------------------------------------------------------------------------------------
median_min_max <- function(x) {
  qs <- quantile(x, c(0.5, 0, 1))
  data.frame(median = qs[1],
             minimum = qs[2],
             maximum = qs[3])
}
heights |>
  filter(sex == "Female") |>
  summarise(median_min_max(height))


## ---------------------------------------------------------------------------------------------
heights |> group_by(sex)


## ---------------------------------------------------------------------------------------------
heights |>
  group_by(sex) |>
  summarise(average = mean(height), standard_deviation = sd(height))


## ---------------------------------------------------------------------------------------------
murders |>
  group_by(region) |>
  summarise(median_min_max(rate))


## ---------------------------------------------------------------------------------------------
class(us_murder_rate)


## ---------------------------------------------------------------------------------------------
us_murder_rate |> pull(rate)


## ---------------------------------------------------------------------------------------------
us_murder_rate <- murders |>
  summarise(rate = sum(total) / sum(population) * 10^5) |>
  pull(rate)

us_murder_rate

## ---------------------------------------------------------------------------------------------
class(us_murder_rate)


## ---------------------------------------------------------------------------------------------
murders |>
  arrange(population) |>
  head()


## ---------------------------------------------------------------------------------------------
murders |>
  arrange(rate) |>
  head()


## ---------------------------------------------------------------------------------------------
murders |>
  arrange(desc(rate)) |>
  head()


## ---------------------------------------------------------------------------------------------
murders |>
  arrange(region, rate) |>
  head()


## ---------------------------------------------------------------------------------------------
murders |>
  top_n(5, rate)


## ---------------------------------------------------------------------------------------------
murders |>
  slice_max(rate, n = 5)


## ---------------------------------------------------------------------------------------------
library(NHANES)
data(NHANES)


## ---------------------------------------------------------------------------------------------
library(dslabs)
data(na_example)
mean(na_example)
sd(na_example)


## ---------------------------------------------------------------------------------------------
mean(na_example, na.rm = TRUE)
sd(na_example, na.rm = TRUE)


## ---------------------------------------------------------------------------------------------
NHANES |>
  head()


## ---------------------------------------------------------------------------------------------
ref <- NHANES |>
  filter(AgeDecade == " 20-29") |>
  summarise(mean(BPSysAve, na.rm = TRUE))
ref


## ---------------------------------------------------------------------------------------------
ref_avg <- NHANES |>
  filter(AgeDecade == " 20-29") |>
  pull(BPSysAve) |>
  mean(na.rm = TRUE)
ref_avg


## ---------------------------------------------------------------------------------------------
ref_min <- NHANES |>
  filter(AgeDecade == " 20-29") |>
  pull(BPSysAve) |>
  min(na.rm = TRUE)
ref_min
ref_max <- NHANES |>
  filter(AgeDecade == " 20-29") |>
  pull(BPSysAve) |>
  max(na.rm = TRUE)
ref_max


## ---------------------------------------------------------------------------------------------
NHANES |>
  filter(Gender == "female") |>
  group_by(AgeDecade) |>
  summarise(average = mean(BPSysAve, na.rm = TRUE), standard_deviation = sd(BPSysAve, na.rm = TRUE))


## ---------------------------------------------------------------------------------------------
NHANES |>
  filter(Gender == "male") |>
  group_by(AgeDecade) |>
  summarise(average = mean(BPSysAve, na.rm = TRUE), standard_deviation = sd(BPSysAve, na.rm = TRUE))


## ---------------------------------------------------------------------------------------------
NHANES |>
  group_by(Gender, AgeDecade) |>
  summarise(average = mean(BPSysAve, na.rm = TRUE), standard_deviation = sd(BPSysAve, na.rm = TRUE))


## ---------------------------------------------------------------------------------------------
NHANES |>
  filter(Gender == "male", AgeDecade == " 40-49") |>
  group_by(Race1)|>
  summarise(average = mean(BPSysAve, na.rm = TRUE), 
            standard_deviation = sd(BPSysAve, na.rm = TRUE)) |>
  arrange(average)


## ---------------------------------------------------------------------------------------------
murders |> group_by(region)

## ---------------------------------------------------------------------------------------------
murders |> group_by(region) |> class()


## ---------------------------------------------------------------------------------------------
murders

## ---------------------------------------------------------------------------------------------
as_tibble(murders)


## ---------------------------------------------------------------------------------------------
class(murders[,4])

## ---------------------------------------------------------------------------------------------
class(as_tibble(murders[,4]))


## ---------------------------------------------------------------------------------------------
murders$Population

## ---------------------------------------------------------------------------------------------
as_tibble(murders)$Poplation


## ---------------------------------------------------------------------------------------------
tibble(id=c(1, 2, 3), func = c(mean, median, sd))


## ---------------------------------------------------------------------------------------------
tibble(names = c("John", "Juan", "Jean", "Yao"),
       exam_1 = c(95, 80, 90, 85),
       exam_2 = c(90, 85, 85, 90)) -> grades
grades


## ---------------------------------------------------------------------------------------------
log(8, base = 2)
2 |> log(8, base = _)
2 %>% log(8, base = .)


## ---------------------------------------------------------------------------------------------
compute_s_n <- function(n) {
  x <- 1:n
  sum(x)
}
n <- 1:25
s_n <- sapply(n, compute_s_n)
s_n


## ---------------------------------------------------------------------------------------------
library(purrr)
s_n <- map(n, compute_s_n)
class(s_n)


## ---------------------------------------------------------------------------------------------
s_n <- map_dbl(n, compute_s_n)
class(s_n)


## ---------------------------------------------------------------------------------------------
# s_n <- map_df(n, compute_s_n)


## ---------------------------------------------------------------------------------------------
## compute_s_n <- function(n) {
##   x <- 1:n
##   sum(x)
##  }

compute_s_n <- function(n) {
  x <- 1:n
  tibble(sum = sum(x))
}
s_n <- map_df(n, compute_s_n)
s_n


## ---------------------------------------------------------------------------------------------
x <- c(-2, -1, 0, 1, 2)
case_when(x < 0 ~ "Negative",
          x > 0 ~ "Positive",
          TRUE ~ "Zero")


## ---------------------------------------------------------------------------------------------
murders |>
  mutate(group = case_when(
    abb %in% c("ME", "NH", "VT", "MA", "RI", "CT") ~ "New England",
    abb %in% c("WA", "OR", "CA") ~ "West Coast",
    region == "South" ~ "South",
    TRUE ~ "Other")) |>
  group_by(group) |>
  summarise(rate = sum(total) / sum(population) * 10^5)


## ---------------------------------------------------------------------------------------------
murders


## ---------------------------------------------------------------------------------------------
murders_tibble <- as_tibble(murders)
murders_tibble


## ---------------------------------------------------------------------------------------------
murders |>
  group_by(region)


## ---------------------------------------------------------------------------------------------
murders |>
  pull(population) |> 
  log() |>
  mean() |>
  exp()


## ---------------------------------------------------------------------------------------------
n <- 1:100
summer <- function (n) {
  x <- 1:n
  tibble(sum = sum(x))
}
n <- 1:100
s_n <- map_df(n, summer)
s_n_2 <- map_df(n, summer)
my_df <- data.frame(
  n = n,
  s_n = s_n,
  s_n_2 = s_n_2
)
names(my_df) <- c("n", "s_n", "s_n_2")
my_df

